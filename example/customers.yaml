data_source:
  name: customer_dim
  description: Location and description of all customers
  owners:
    - support@transformdata.io

  identifiers:
    - name: customer
      type: primary
      expr: id_customer

  measures:
    - name: new_customers
      expr: "1"
      agg: sum

  dimensions:
    - name: ds
      type: time
      type_params:
        is_primary: True
        time_format: YYYY-MM-DD
        time_granularity: day
    - name: country
      description: The country where the customer is located.
      type: categorical

  mutability:
    type: immutable

  sql_query: |
    SELECT
      'c500003'             AS id_customer
      , 'MX'                AS country
      , '2022-01-25'        AS ds
    UNION ALL SELECT 'c500022', 'CA', '2022-01-26'
    UNION ALL SELECT 'c500000', 'US', '2022-01-28'
    UNION ALL SELECT 'c500016', 'US', '2022-01-28'
    UNION ALL SELECT 'c500024', 'BR', '2022-01-29'
    UNION ALL SELECT 'c500008', 'BR', '2022-01-31'
    UNION ALL SELECT 'c500039', 'BR', '2022-01-31'
    UNION ALL SELECT 'c500003', 'CA', '2022-01-31'
    UNION ALL SELECT 'c500029', 'CA', '2022-01-31'
    UNION ALL SELECT 'c500041', 'US', '2022-02-01'
    UNION ALL SELECT 'c500015', 'GR', '2022-02-01'
    UNION ALL SELECT 'c500042', 'GR', '2022-02-02'
    UNION ALL SELECT 'c500021', 'GR', '2022-02-02'
    UNION ALL SELECT 'c500028', 'MX', '2022-02-08'
    UNION ALL SELECT 'c500037', 'FR', '2022-02-08'
    UNION ALL SELECT 'c500047', 'BR', '2022-02-10'
    UNION ALL SELECT 'c500010', 'GR', '2022-02-11'
    UNION ALL SELECT 'c500050', 'MX', '2022-02-13'
    UNION ALL SELECT 'c500040', 'FR', '2022-02-13'
    UNION ALL SELECT 'c500043', 'FR', '2022-02-13'
    UNION ALL SELECT 'c500019', 'GR', '2022-02-13'
    UNION ALL SELECT 'c500036', 'BR', '2022-02-15'
    UNION ALL SELECT 'c500044', 'FR', '2022-02-18'
    UNION ALL SELECT 'c500045', 'CA', '2022-02-21'
    UNION ALL SELECT 'c500013', 'CA', '2022-02-21'
    UNION ALL SELECT 'c500006', 'BR', '2022-02-21'
    UNION ALL SELECT 'c500011', 'US', '2022-02-23'
    UNION ALL SELECT 'c500025', 'US', '2022-02-27'
    UNION ALL SELECT 'c500004', 'BR', '2022-03-02'
    UNION ALL SELECT 'c500007', 'CA', '2022-03-03'
    UNION ALL SELECT 'c500005', 'MX', '2022-03-04'
    UNION ALL SELECT 'c500031', 'GR', '2022-03-05'
    UNION ALL SELECT 'c500002', 'CA', '2022-03-05'
    UNION ALL SELECT 'c500023', 'US', '2022-03-06'
    UNION ALL SELECT 'c500032', 'BR', '2022-03-11'
    UNION ALL SELECT 'c500026', 'CA', '2022-03-11'
    UNION ALL SELECT 'c500020', 'GR', '2022-03-12'
    UNION ALL SELECT 'c500027', 'GR', '2022-03-15'
    UNION ALL SELECT 'c500046', 'US', '2022-03-15'
    UNION ALL SELECT 'c500034', 'BR', '2022-03-19'
    UNION ALL SELECT 'c500014', 'GR', '2022-03-20'
    UNION ALL SELECT 'c500033', 'CA', '2022-03-20'
    UNION ALL SELECT 'c500049', 'FR', '2022-03-22'
    UNION ALL SELECT 'c500001', 'GR', '2022-03-23'
    UNION ALL SELECT 'c500035', 'CA', '2022-03-23'
    UNION ALL SELECT 'c500017', 'BR', '2022-03-24'
    UNION ALL SELECT 'c500030', 'CA', '2022-03-25'
    UNION ALL SELECT 'c500018', 'GR', '2022-03-26'
