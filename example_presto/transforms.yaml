version: v0.1
data_source:
  name: transforms_fct
  description: This table captures the number of transformations that the Transformer bots performed, starting in Oct 2020.
  owners:
    - transformer@transformdata.io
  sql_query: |
    SELECT 
      t.*
    FROM (
      VALUES
    (1, 20, 212, 0, '2020-10-02'),
    (2, 9, 140, 1, '2020-10-03'),
    (3, 34, 424, 1, '2020-10-04'),
    (4, 36, 445, 0, '2020-10-05'),
    (5, 43, 64, 1, '2020-10-06'),
    (6, 36, 414, 0, '2020-10-07'),
    (7, 46, 224, 1, '2020-10-08'),
    (8, 13, 28, 0, '2020-10-09'),
    (9, 18, 163, 1, '2020-10-10'),
    (10, 2, 228, 1, '2020-10-11'),
    (11, 45, 69, 0, '2020-10-12'),
    (12, 38, 282, 0, '2020-10-13'),
    (13, 27, 290, 0, '2020-10-14'),
    (14, 27, 338, 0, '2020-10-15'),
    (15, 15, 290, 0, '2020-10-16'),
    (16, 2, 366, 0, '2020-10-17'),
    (17, 12, 130, 1, '2020-10-18'),
    (18, 8, 127, 0, '2020-10-19'),
    (19, 45, 324, 1, '2020-10-20'),
    (20, 13, 417, 0, '2020-10-01'),
    (21, 36, 357, 1, '2020-10-02'),
    (22, 46, 357, 0, '2020-10-03'),
    (23, 1, 259, 1, '2020-10-04'),
    (24, 8, 45, 1, '2020-10-05'),
    (25, 18, 419, 1, '2020-10-06'),
    (26, 35, 153, 0, '2020-10-07'),
    (27, 33, 256, 0, '2020-10-08'),
    (28, 48, 182, 1, '2020-10-09'),
    (29, 45, 30, 0, '2020-10-10'),
    (30, 27, 88, 1, '2020-10-11'),
    (31, 33, 37, 0, '2020-10-12'),
    (32, 33, 369, 0, '2020-10-13'),
    (33, 3, 448, 0, '2020-10-14'),
    (34, 49, 425, 1, '2020-10-15'),
    (35, 40, 344, 0, '2020-10-16'),
    (36, 50, 440, 1, '2020-10-17'),
    (37, 29, 422, 0, '2020-10-18'),
    (38, 3, 24, 0, '2020-10-19'),
    (39, 5, 389, 0, '2020-10-20'),
    (40, 27, 242, 0, '2020-10-01'),
    (41, 30, 310, 0, '2020-10-02'),
    (42, 20, 161, 1, '2020-10-03'),
    (43, 8, 26, 1, '2020-10-04'),
    (44, 13, 387, 1, '2020-10-05'),
    (45, 25, 202, 0, '2020-10-06'),
    (46, 9, 19, 0, '2020-10-07'),
    (47, 5, 22, 1, '2020-10-08'),
    (48, 3, 111, 1, '2020-10-09'),
    (49, 41, 53, 1, '2020-10-10'),
    (50, 3, 256, 0, '2020-10-11'),
    (51, 23, 95, 0, '2020-10-12'),
    (52, 39, 307, 1, '2020-10-13'),
    (53, 46, 215, 1, '2020-10-14'),
    (54, 10, 270, 0, '2020-10-15'),
    (55, 10, 252, 0, '2020-10-16'),
    (56, 28, 74, 0, '2020-10-17'),
    (57, 14, 447, 0, '2020-10-18'),
    (58, 6, 81, 0, '2020-10-19'),
    (59, 26, 441, 1, '2020-10-20'),
    (60, 48, 385, 0, '2020-10-01'),
    (61, 40, 441, 1, '2020-10-02'),
    (62, 7, 161, 0, '2020-10-03'),
    (63, 18, 299, 0, '2020-10-04'),
    (64, 48, 328, 1, '2020-10-05'),
    (65, 20, 147, 0, '2020-10-06'),
    (66, 4, 196, 1, '2020-10-07'),
    (67, 26, 435, 0, '2020-10-08'),
    (68, 35, 196, 1, '2020-10-09'),
    (69, 47, 73, 1, '2020-10-10'),
    (70, 15, 54, 0, '2020-10-11'),
    (71, 50, 162, 1, '2020-10-12'),
    (72, 39, 190, 0, '2020-10-13'),
    (73, 47, 71, 1, '2020-10-14'),
    (74, 26, 177, 0, '2020-10-15'),
    (75, 43, 404, 1, '2020-10-16'),
    (76, 16, 404, 1, '2020-10-17'),
    (77, 49, 73, 1, '2020-10-18'),
    (78, 21, 53, 1, '2020-10-19'),
    (79, 39, 303, 0, '2020-10-20'),
    (80, 4, 338, 0, '2020-10-01'),
    (81, 26, 213, 0, '2020-10-02'),
    (82, 45, 142, 1, '2020-10-03'),
    (83, 4, 441, 0, '2020-10-04'),
    (84, 27, 303, 0, '2020-10-05'),
    (85, 27, 28, 1, '2020-10-06'),
    (86, 11, 389, 0, '2020-10-07'),
    (87, 40, 91, 1, '2020-10-08'),
    (88, 29, 102, 0, '2020-10-09'),
    (89, 24, 134, 0, '2020-10-10'),
    (90, 43, 46, 1, '2020-10-11'),
    (91, 17, 312, 0, '2020-10-12'),
    (92, 4, 209, 1, '2020-10-13'),
    (93, 50, 127, 1, '2020-10-14'),
    (94, 26, 104, 1, '2020-10-15'),
    (95, 24, 98, 0, '2020-10-16'),
    (96, 42, 175, 1, '2020-10-17'),
    (97, 41, 273, 0, '2020-10-18'),
    (98, 27, 25, 1, '2020-10-19'),
    (99, 48, 230, 0, '2020-10-20'),
    (100, 20, 134, 1, '2020-10-01')
    ) AS t (id_transformation, id_bot, m_transforms, dim_is_visible, ds)

  identifiers:
    - name: tranform
      type: primary
      expr: id_transformation
    - name: bot
      type: foreign
      expr: id_bot

  measures:
    - name: transforms
      description: The total number of transforms performed by the transformer bots.
      expr: m_transforms
      agg: sum
    - name: visible_transforms
      description: The total number of visible transforms performed by the transformer bots.
      expr: CASE WHEN dim_is_visible THEN m_transforms ELSE 0 END
      agg: sum

  dimensions:
    - name: ds
      type: time
    - name: is_visible
      type: categorical
      expr: dim_is_visible

  mutability:
    type: ds_append_only
