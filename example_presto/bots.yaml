version: v0.1
data_source:
  name: bots_dim
  description: For each transformer bot, additional information about the bot.
  owners:
    - transformer@transformdata.io
  sql_query: |
    SELECT 
      t.*
    FROM (
      VALUES 
      ( 1,       'bdbbbffafbdeece', 0, '2020-10-02'),
      ( 2,   'bdbfefefadcaaaebddf', 1, '2020-10-03'),
      ( 3,                'fbaacc', 1, '2020-10-04'),
      ( 4,               'dabecbf', 0, '2020-10-05'),
      ( 5,       'fdebeaddfdfdddd', 0, '2020-10-06'),
      ( 6,            'cfeccfbfca', 0, '2020-10-07'),
      ( 7,         'bacfcabcffbed', 1, '2020-10-08'),
      ( 8,           'effbcfcedbf', 1, '2020-10-09'),
      ( 9,     'eabadebcbadcfcbcf', 1, '2020-10-10'),
      (10,          'cfefceabdcfa', 1, '2020-10-11'),
      (11,         'eeedcfeebffda', 1, '2020-10-12'),
      (12,         'cefefebcaface', 1, '2020-10-13'),
      (13,            'bcaaaffeea', 0, '2020-10-14'),
      (14,          'ebadadaaeedf', 1, '2020-10-15'),
      (15,         'eebcaaebdbcbe', 1, '2020-10-16'),
      (16,            'bdbfedebcd', 1, '2020-10-17'),
      (17,         'dbaabaadfdeab', 1, '2020-10-18'),
      (18,           'abbeaceabae', 1, '2020-10-19'),
      (19,            'ffcbfadffb', 1, '2020-10-20'),
      (20,    'caccbedacecffefbfa', 1, '2020-10-01'),
      (21,       'acfedbacfbaebbe', 0, '2020-10-02'),
      (22,       'eebfacaadbecbdb', 1, '2020-10-03'),
      (23,       'ffecafdadeebcad', 0, '2020-10-04'),
      (24,          'ddccebedadca', 1, '2020-10-05'),
      (25,            'edfceaaccf', 1, '2020-10-06'),
      (26,            'aaadaaeafc', 1, '2020-10-07'),
      (27,          'bbfdbfbeacaf', 1, '2020-10-08'),
      (28,          'ddcbbdbdcdee', 0, '2020-10-09'),
      (29,           'ddacabfebcf', 0, '2020-10-10'),
      (30,            'edddafebef', 1, '2020-10-11'),
      (31,            'eeaefdcbef', 0, '2020-10-12'),
      (32,              'cdeaaefc', 1, '2020-10-13'),
      (33,         'bfbadabccecec', 1, '2020-10-14'),
      (34,    'cddbafdbbabbeeaeff', 1, '2020-10-15'),
      (35,           'bdccfdaabef', 0, '2020-10-16'),
      (36,        'bfdadbffafaaaa', 0, '2020-10-17'),
      (37,        'abcebdcdbcebfd', 0, '2020-10-18'),
      (38,                 'acbcf', 1, '2020-10-19'),
      (39,          'deadcdfacbaa', 1, '2020-10-20'),
      (40,         'aaeffacebdbab', 1, '2020-10-01'),
      (41,               'ebdeeee', 0, '2020-10-02'),
      (42,        'aeebfeeadeedff', 0, '2020-10-03'),
      (43,           'fcacedfbabc', 0, '2020-10-04'),
      (44,         'dcecedfcccace', 1, '2020-10-05'),
      (45,        'dabddabebcebac', 0, '2020-10-06'),
      (46,            'eeaaaedacc', 0, '2020-10-07'),
      (47,         'fdeaefcbdcdce', 0, '2020-10-08'),
      (48,             'cacbaaccb', 1, '2020-10-09'),
      (49,            'cfaafaadbc', 1, '2020-10-10'),
      (50,          'bbeaffadfcda', 1, '2020-10-11')
      ) AS t (id_bot, bot_name, is_evil, ds)

  identifiers:
    - name: bot
      type: primary
      expr: id_bot

  measures:
    - name: bots
      description: The total number of transformer bots.
      expr: "1"
      agg: sum

  dimensions:
    - name: ds
      type: time
    - name: bot_name
      type: categorical
    - name: good_or_evil
      type: categorical
      expr: CASE WHEN is_evil = 1 THEN 'evil' ELSE 'good' END

  mutability:
    type: ds_append_only
